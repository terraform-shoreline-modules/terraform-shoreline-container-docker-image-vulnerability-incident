{
  "name": "docker_image_vulnerability_incident",
  "description": "A Docker Image Vulnerability Incident refers to a situation where an issue is discovered with a Docker image that could potentially compromise the security of the system. Docker images are containers that hold all the necessary components and dependencies required to run an application, and if one of these images is found to be vulnerable, it could allow an attacker to gain unauthorized access to the system or perform malicious actions. This type of incident typically requires urgent attention and remediation to ensure that the system is secure and protected.",
  "params": [
    {
      "name": "PATH_TO_DOCKERFILE",
      "value": ""
    },
    {
      "name": "NAME_OF_AFFECTED_DOCKER_IMAGE",
      "value": ""
    },
    {
      "name": "IMAGE_NAME",
      "value": ""
    },
    {
      "name": "PACKAGE_NAME",
      "value": ""
    },
    {
      "name": "HOST_NAME",
      "value": ""
    },
    {
      "name": "K8S_CLUSTER_NAME",
      "value": ""
    },
    {
      "name": "NAMESPACE",
      "value": ""
    }
  ],
  "cells": [
    {
      "name": "cell_1",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Docker Image Vulnerability Incident\nA Docker Image Vulnerability Incident refers to a situation where an issue is discovered with a Docker image that could potentially compromise the security of the system. Docker images are containers that hold all the necessary components and dependencies required to run an application, and if one of these images is found to be vulnerable, it could allow an attacker to gain unauthorized access to the system or perform malicious actions. This type of incident typically requires urgent attention and remediation to ensure that the system is secure and protected."
    },
    {
      "name": "cell_2",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check Docker version"
    },
    {
      "name": "cell_3",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `docker version`"
    },
    {
      "name": "cell_4",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## List all running Docker containers"
    },
    {
      "name": "cell_5",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `docker ps`"
    },
    {
      "name": "cell_6",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check if there are any vulnerabilities in the image"
    },
    {
      "name": "cell_7",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `docker scan ${IMAGE_NAME}`"
    },
    {
      "name": "cell_8",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check if there are any security issues in the Dockerfile"
    },
    {
      "name": "cell_9",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `docker scan --file ${PATH_TO_DOCKERFILE}`"
    },
    {
      "name": "cell_10",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check for any installed packages with known vulnerabilities"
    },
    {
      "name": "cell_11",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `dpkg -l | grep -i ${PACKAGE_NAME}`"
    },
    {
      "name": "cell_12",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check for any installed packages with known vulnerabilities in Alpine Linux"
    },
    {
      "name": "cell_13",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `apk info | grep -i ${PACKAGE_NAME}`"
    },
    {
      "name": "cell_14",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check if there are any vulnerabilities in the operating system"
    },
    {
      "name": "cell_15",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `sudo apt-get update && sudo apt-get upgrade`"
    },
    {
      "name": "cell_16",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Identify the affected Docker images and stop their usage across all systems."
    },
    {
      "name": "cell_17",
      "type": "OP_LANG",
      "enabled": true,
      "content": "host | host_name=$HOST_NAME | invoke_docker_cleanup($NAME_OF_AFFECTED_DOCKER_IMAGE, $IMAGE_NAME)"
    }
  ]
}